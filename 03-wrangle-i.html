<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>I: Enter the tidyverse – EDH 7916</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./apple-touch-icon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-29a703985b9506ee1f3285ce059650bf.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-329a8742cc536dc1b7a94a813afad969.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="site-attachments/styles.css">
<meta property="og:title" content="I: Enter the tidyverse – EDH 7916">
<meta property="og:image" content="https://capaldi.info/7916/apple-touch-icon.png">
<meta property="og:site_name" content="EDH 7916">
<meta property="og:image:height" content="180">
<meta property="og:image:width" content="180">
<meta name="twitter:title" content="I: Enter the tidyverse – EDH 7916">
<meta name="twitter:image" content="https://capaldi.info/7916/apple-touch-icon.png">
<meta name="twitter:image-height" content="180">
<meta name="twitter:image-width" content="180">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-wrangle-i.html">Data Wrangling</a></li><li class="breadcrumb-item"><a href="./03-wrangle-i.html">I: Enter the tidyverse</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">EDH 7916</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homepage</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-set-install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">I: Installing R &amp; RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-set-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">II: Reading Data &amp; IPEDS</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Wrangling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-wrangle-i.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">I: Enter the tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-wrangle-ii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">II: Appending, joining, &amp; reshaping data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-wrangle-iii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">III: Working with strings &amp; dates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-wrangle-iv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IV: Advanced `tidyverse` &amp; Data Retrieval</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-viz-i.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">I: Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-viz-ii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">II: Customization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-viz-iii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">III: Maps &amp; Spatial Data (Feat. APIs)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-quarto-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproducible Reports with Quarto</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-pro-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Functions &amp; Loops</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-pro-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bringing it All Together (Feat. Basic Models)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Project</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Extra Credit</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./x-01-git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">I: Git &amp; GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./x-02-dload-ipeds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">II: Skinner’s Download IPEDS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./x-03-vanilla.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">III: Data Wrangling I Redux: Vanilla R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./x-04-skinner-phil.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IV: Skinner’s Philosophy of Data Wrangling</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-wrangle-i.html">Data Wrangling</a></li><li class="breadcrumb-item"><a href="./03-wrangle-i.html">I: Enter the tidyverse</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">I: Enter the tidyverse</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Lesson</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Assignment</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><a href="./r-scripts/03-wrangle-i.R"><i class="fa-solid fa-code" aria-label="code"></i> R Code</a></p>
<ul>
<li>Today we take our first full dive into R. Though every data wrangling / analysis is unique, the best way to learn and practice R is to answer a question using data, which is how this lesson is set up</li>
<li>By the end of this lesson, you will have read in a data set, lightly cleaned it, produced results, and saved your findings in a new file
<ul>
<li>As part of this process, you will have practiced translating a research question into data analysis steps, which is a skill every bit as important as technical sophistication with a statistical language like R</li>
</ul></li>
</ul>
<section id="re-urgent-data-question-from-the-provost" class="level2">
<h2 data-anchor-id="re-urgent-data-question-from-the-provost">Re: Urgent Data Question from the Provost</h2>
<ul>
<li>Through today’s lesson, we will explore some of the basics of data wrangling
<ul>
<li>But to make it more realistic, we will be doing so to answer a realistic question you may be asked by your advisor or supervisor</li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p>Using HSLS09 data, figure out average differences in college degree expectations across census regions; for a first pass, ignore missing values and use the higher of student and parental expectations if an observation has both.</p>
</blockquote>
<ul>
<li>A primary skill (often unremarked upon) in data analytic work is translation. Your advisor, IR director, funding agency director — even collaborator — won’t speak to you in the language of R
<ul>
<li>Instead, it’s up to you to
<ol type="1">
<li>translate a research question into the discrete steps coding steps necessary to provide an answer, and then</li>
<li>translate the answer such that everyone understands what you’ve found</li>
</ol></li>
</ul></li>
</ul>
<p>What we need to do is some combination of the following:</p>
<ol type="1">
<li><strong>Read</strong> in the data</li>
<li><strong>Select</strong> the variables we need</li>
<li><strong>Mutate</strong> a new value that’s the higher of student and parental degree expectations</li>
<li><strong>Filter</strong> out observations with missing degree expectation values</li>
<li><strong>Summarize</strong> the data within region to get average degree expectation values</li>
<li><strong>Write</strong> out the results to a file so we have it for later</li>
</ol>
<p>Let’s do it!</p>
<ul>
<li>Throughout this lesson (and class), we are going to lean heavily on the <code>tidyverse</code> collection of packages
<ul>
<li>If you don’t already have this installed, use <code>install.packages("tidyverse")</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
</section>
<section id="check-working-directory" class="level2">
<h2 data-anchor-id="check-working-directory">Check working directory</h2>
<ul>
<li><p>This script — like the one from the <a href="./02-set-data.html">organizing lesson</a> — assumes that the class folder is the working directory and that the required data file is in the <code>data</code> sub-directory</p></li>
<li><p>If you need a refresher on setting the working directory, see the <a href="./02-set-data.html">prior lesson</a>.</p></li>
<li><p><strong>Notice</strong> that I’m not setting (<em>i.e.</em> hard coding) the working directory in the script. That would not work well for sharing the code. Instead, I tell you where you need to be (a common landmark), let you get there, and then rely on relative paths afterwards</p></li>
</ul>
<section id="reading-data-in-with-read_csv" class="level3">
<h3 data-anchor-id="reading-data-in-with-read_csv">Reading Data in with <code>read_csv()</code></h3>
<ul>
<li>For this lesson, we’ll use a subset of the <a href="https://nces.ed.gov/surveys/hsls09/">High School Longitudinal Study of 2009 (HSLS09)</a>, an IES /NCES data set that features:</li>
</ul>
<blockquote class="blockquote">
<ul>
<li>Nationally representative, longitudinal study of 23,000+ 9th graders from 944 schools in 2009, with a first follow-up in 2012 and a second follow-up in 2016<br>
</li>
<li>Students followed throughout secondary and postsecondary years<br>
</li>
<li>Surveys of students, their parents, math and science teachers, school administrators, and school counselors<br>
</li>
<li>A new student assessment in algebraic skills, reasoning, and problem solving for 9th and 11th grades<br>
</li>
<li>10 state representative data sets</li>
</ul>
</blockquote>
<ul>
<li><p>If you are interested in using HSLS09 for future projects, <strong>DO NOT</strong> rely on this subset. Be sure to download the full data set with all relevant variables and weights if that’s the case. But for our purposes in this lesson, it will work just fine.</p></li>
<li><p>Throughout, we’ll need to consult the code book. An <a href="https://nces.ed.gov/datalab/onlinecodebook">online version can be found at this link</a>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## data are CSV, so we use read_csv() from the readr library</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"hsls-small.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 23503 Columns: 16
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (16): stu_id, x1sex, x1race, x1stdob, x1txmtscor, x1paredu, x1hhnumber, ...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<ul>
<li><p>You may notice the <code>read_csv()</code> prints out information about the data just read in. Nothing is wrong! The <code>read_csv()</code> function, like many other functions in the tidyverse, assumes you’d rather have more rather than less information and acts accordingly</p></li>
<li><p>Up to now, this should all seem fairly consistent with last week’s lesson. This is just the set up, now it’s time to dive in!</p></li>
</ul>
</section>
</section>
<section id="pipe-operator-in-r" class="level2">
<h2 data-anchor-id="pipe-operator-in-r">Pipe Operator <code>|&gt;</code> in R</h2>
<p>The pipe is one of the things that makes R code more intuitive than other programming languages, as it allows us write code in the order we think about it, passing it one from one function to another, rather than nesting it like traditional code would be written</p>
<p>For this example don’t worry about the actual processes (we will go over them more below), just look at how much more intuitive the code is with <code>|&gt;</code>s.</p>
<p>First, let’s say I want to take the data we just read in and <code>select</code> the <code>x1txmtscor</code> (math test scores) column</p>
<section id="without" class="level4">
<h4 data-anchor-id="without">Without <code>|&gt;</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Without |&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(df, x1txmtscor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="with" class="level4">
<h4 data-anchor-id="with">With <code>|&gt;</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## With |&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">select</span>(x1txmtscor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Neither is that confusing… But, what if we want to take that output and select only students with a math score above 50?</p>
</section>
<section id="without-1" class="level4">
<h4 data-anchor-id="without-1">Without <code>|&gt;</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Without |&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="fu">select</span>(df, x1txmtscor), x1txmtscor <span class="sc">&gt;</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="with-1" class="level4">
<h4 data-anchor-id="with-1">With <code>|&gt;</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## With |&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">select</span>(x1txmtscor) <span class="sc">|&gt;</span> <span class="fu">filter</span>(x1txmtscor <span class="sc">&gt;</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See how the non-piped version is getting messy? Let’s add one more level to really make the point, creating a new variable that is the square root of the test score</p>
</section>
<section id="without-2" class="level4">
<h4 data-anchor-id="without-2">Without <code>|&gt;</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Without |&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="fu">filter</span>(<span class="fu">select</span>(df, x1txmtscor), x1txmtscor <span class="sc">&gt;</span> <span class="dv">50</span>), <span class="at">square_root =</span> <span class="fu">sqrt</span>(x1txmtscor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="with-2" class="level4">
<h4 data-anchor-id="with-2">With <code>|&gt;</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## With |&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">select</span>(x1txmtscor) <span class="sc">|&gt;</span> <span class="fu">filter</span>(x1txmtscor <span class="sc">&gt;</span> <span class="dv">50</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">square_root =</span> <span class="fu">sqrt</span>(x1txmtscor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we are getting longer, I’m going to use a new line for each pipe, just to make it even clearer (it makes no difference to R)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Best to use  a new line for each pipe when code gets longer</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x1txmtscor) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x1txmtscor <span class="sc">&gt;</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">square_root =</span> <span class="fu">sqrt</span>(x1txmtscor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Even though we haven’t covered any of these commands yet, I think (tell me if I’m wrong) the <code>|&gt;</code> is still pretty easy to know roughly what’s going on. Whereas, the traditional nested way gets really tricky beyond a couple of commands.</p>
<p>Of course, if you wanted, you could do each step separately, constantly assigning and overwriting an object like below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Without the |&gt;, we could technically break it down step by step</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">select</span>(df, x1txmtscor)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">filter</span>(temp, x1txmtscor <span class="sc">&gt;</span> <span class="dv">50</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">mutate</span>(temp, <span class="at">square_root =</span> <span class="fu">sqrt</span>(x1txmtscor))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But again, I think it’s less intuitive than simply piping the results.</p>
<ul>
<li>If we do want to see step-by-step output in a piped command, you can either
<ol type="a">
<li>Run the code as you write it line-by-line (usually what I do)</li>
<li>Highlight sections of the piped code to run up to a point</li>
</ol></li>
</ul>
</section>
<section id="assigning-output-from-pipes" class="level4">
<h4 data-anchor-id="assigning-output-from-pipes">Assigning Output from Pipes</h4>
<ul>
<li>Assigning output from pipes is the same as we have covered a few times, we use a <code>&lt;-</code> to pass it backwards to an object (in this case we called that object <code>df_backward_pass</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Always assign backwards</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_backward_pass <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x1txmtscor) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x1txmtscor <span class="sc">&gt;</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">square_root =</span> <span class="fu">sqrt</span>(x1txmtscor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>If you want to think of it this way, we are effectively continuing to pass it forward like this…</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## You can think of the assignment as a continuation of the pipe like this</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="do">## but don't write it this way, it's then hard to find what you called something later</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x1txmtscor) <span class="sc">|&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x1txmtscor <span class="sc">&gt;</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">square_root =</span> <span class="fu">sqrt</span>(x1txmtscor)) <span class="ot">-&gt;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  df_forward_pass</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>That’s how I first thought about how pipes and assignment work together, and you can see the outputs are <code>all.equal()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Checking they are the same</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(df_backward_pass, df_forward_pass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<ul>
<li>However, you <em>really</em> shouldn’t write code like this, as although it runs, it’s then hard to later find where you created <code>df_forward_pass</code>.</li>
<li>Starting the string of code with where you store the result is <strong>MUCH</strong> clearer.
<ul>
<li>But, it really helped me to think about it this way at first, so hopefully it will help some of you understand how <code>|&gt;</code> and <code>&lt;-</code> work together</li>
</ul></li>
</ul>
</section>
<section id="a-brief-history-of-the-r-pipe" class="level4">
<h4 data-anchor-id="a-brief-history-of-the-r-pipe">A Brief History of the R Pipe</h4>
<p><span style="display:block;text-align:center"><a href="https://www.fine-arts-museum.be/uploads/exhibitions/images/magritte_la_trahison_des_images_large@2x.jpg"><img src="https://raw.githubusercontent.com/tidyverse/magrittr/main/man/figures/logo.png" class="img-fluid" alt="badge"></a></span></p>
<ul>
<li>The pipe was originally a <code>tidyverse</code> invention, and used <code>%&gt;%</code> symbol, which is probably still a common pipe you see “in the wild”</li>
<li>The pipe we are using was brought into the Vanilla version of R a few years ago as <code>|&gt;</code></li>
<li>The reason for the change is some benefits that are beyond the scope of this class, but I wanted you to be aware that <code>|&gt;</code> and <code>%&gt;%</code> <ins>are essentially the same thing</ins>
<ul>
<li>You can intermingle them, but, but for clarity I would stick with <code>|&gt;</code></li>
</ul></li>
</ul>
</section>
</section>
<section id="basic-tidyverse-commands" class="level2">
<h2 data-anchor-id="basic-tidyverse-commands">Basic Tidyverse Commands</h2>
<ul>
<li>Now we have the pipe <code>|&gt;</code> covered, it’s time to dig into some basic data wrangling commands</li>
</ul>
<section id="selecting-variablescolumns-with-select" class="level3">
<h3 data-anchor-id="selecting-variablescolumns-with-select">Selecting Variables/Columns with <code>select()</code></h3>
<ul>
<li>Often data sets contain hundreds, thousands, or even tens of thousands of variables, when we are only interested in a handful. Our first <code>tidyverse</code> command <code>select()</code> helps us deal with this, by, as you may have guessed, <code>select()</code>-ing the variables we want</li>
<li>Since we are going to pipe our R commands, we start with our data then pipe it into the <code>select()</code> command</li>
<li>In the <code>select()</code> command, we list out the variables we want
<ul>
<li><code>stu_id, x1stuedexpct, x1paredexpct, x1region</code>
<ul>
<li>Notice: in this (and most tidyverse) command(s) we don’t have to use “quotes” around the variable names. A common error message when you did need to put something in quotes is <code>Error: object &lt;thing you should have "quoted"&gt; not found</code></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">select</span>(stu_id, x1stuedexpct, x1paredexpct, x1region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23,503 × 4
   stu_id x1stuedexpct x1paredexpct x1region
    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
 1  10001            8            6        2
 2  10002           11            6        1
 3  10003           10           10        4
 4  10004           10           10        3
 5  10005            6           10        3
 6  10006           10            8        3
 7  10007            8           11        1
 8  10008            8            6        1
 9  10009           11           11        3
10  10010            8            6        1
# ℹ 23,493 more rows</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Quick question: if we want to use this reduced data-frame going forward, what should we do?</p>
</blockquote>
<p>That’s right, assign it to an object! Let’s call that <code>df_small</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_small <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">select</span>(stu_id, x1stuedexpct, x1paredexpct, x1region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Our next step is to create a variable that’s the higher of student and parent expectations. Sounds simple enough, but first, we have a problem…
<ul>
<li>Can anyone guess what it is?</li>
</ul></li>
</ul>
</section>
<section id="understanding-our-data" class="level3">
<h3 data-anchor-id="understanding-our-data">Understanding our data</h3>
<p>First things first, however, we need to check the <a href="https://nces.ed.gov/datalab/onlinecodebook">code book</a> to see what the numerical values for our two education expectation variables represent. To save time, I’ve copied them here:</p>
<section id="x1stuedexpct" class="level5">
<h5 data-anchor-id="x1stuedexpct"><code>x1stuedexpct</code></h5>
<p><em>How far in school 9th grader thinks he/she will get</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">value</th>
<th style="text-align: left;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: left;">Less than high school</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: left;">High school diploma or GED</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: left;">Start an Associate’s degree</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: left;">Complete an Associate’s degree</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: left;">Start a Bachelor’s degree</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: left;">Complete a Bachelor’s degree</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: left;">Start a Master’s degree</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: left;">Complete a Master’s degree</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: left;">Start Ph.D/M.D/Law/other prof degree</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: left;">Complete Ph.D/M.D/Law/other prof degree</td>
</tr>
<tr class="odd">
<td style="text-align: center;">11</td>
<td style="text-align: left;">Don’t know</td>
</tr>
<tr class="even">
<td style="text-align: center;">-8</td>
<td style="text-align: left;">Unit non-response</td>
</tr>
</tbody>
</table>
</section>
<section id="x1paredexpct" class="level5">
<h5 data-anchor-id="x1paredexpct"><code>x1paredexpct</code></h5>
<p><em>How far in school parent thinks 9th grader will go</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">value</th>
<th style="text-align: left;">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: left;">Less than high school</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: left;">High school diploma or GED</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: left;">Start an Associate’s degree</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: left;">Complete an Associate’s degree</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: left;">Start a Bachelor’s degree</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: left;">Complete a Bachelor’s degree</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: left;">Start a Master’s degree</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: left;">Complete a Master’s degree</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: left;">Start Ph.D/M.D/Law/other prof degree</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: left;">Complete Ph.D/M.D/Law/other prof degree</td>
</tr>
<tr class="odd">
<td style="text-align: center;">11</td>
<td style="text-align: left;">Don’t know</td>
</tr>
<tr class="even">
<td style="text-align: center;">-8</td>
<td style="text-align: left;">Unit non-response</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-9</td>
<td style="text-align: left;">Missing</td>
</tr>
</tbody>
</table>
<ul>
<li>The good news is that the categorical values are the same for both variables (meaning we can make an easy comparison) and move in a logical progression</li>
<li>The bad news is that we have three values — <code>-8</code>, <code>-9</code>, and <code>11</code> — that we need to deal with so that the averages we compute later represent what we mean</li>
</ul>
</section>
</section>
<section id="exploring-catagorical-variables-with-count" class="level3">
<h3 data-anchor-id="exploring-catagorical-variables-with-count">Exploring Catagorical Variables with <code>count()</code></h3>
<ul>
<li>First, let’s see how many observations are affected by these values using <code>count()</code></li>
</ul>
<blockquote class="blockquote">
<p>Notice that we don’t assign to a new object; this means we’ll see the result in the console, but nothing in our data or object will change</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## see unique values for student expectation</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_small <span class="sc">|&gt;</span> <span class="fu">count</span>(x1stuedexpct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   x1stuedexpct     n
          &lt;dbl&gt; &lt;int&gt;
 1           -8  2059
 2            1    93
 3            2  2619
 4            3   140
 5            4  1195
 6            5   115
 7            6  3505
 8            7   231
 9            8  4278
10            9   176
11           10  4461
12           11  4631</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## see unique values for parental expectation</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df_small <span class="sc">|&gt;</span> <span class="fu">count</span>(x1paredexpct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   x1paredexpct     n
          &lt;dbl&gt; &lt;int&gt;
 1           -9    32
 2           -8  6715
 3            1    55
 4            2  1293
 5            3   149
 6            4  1199
 7            5   133
 8            6  4952
 9            7    76
10            8  3355
11            9    37
12           10  3782
13           11  1725</code></pre>
</div>
</div>
<ul>
<li>Dealing with <code>-8</code> and <code>-9</code> is straight forward — we’ll convert it missing.
<ul>
<li>In R, missing values are technically stored as <code>NA</code>.
<ul>
<li>Not all statistical software uses the same values to represent missing values (for example, STATA uses a dot <code>.</code>)</li>
</ul></li>
<li>NCES has decided to represent missing values as a limited number of negative values. In this case, <code>-8</code> and <code>-9</code> represent missing values</li>
</ul></li>
<li>Note: how to handle missing values is a <strong>very</strong> important topic, one we could spend all semester discussing
<ul>
<li>For now, we are just going to drop observations with missing values; but be forewarned that how you handle missing values can have real ramifications for the quality of your final results</li>
<li>In real research, a better approach is usually to impute missing values, but that is beyond our scope right now</li>
</ul></li>
<li>Deciding what to do with <code>11</code> is a little trickier. While it’s not a missing value <em>per se</em>, it also doesn’t make much sense in its current ordering, that is, to be “higher” than completing a professional degree
<ul>
<li>For now, we’ll make a decision to convert these to <code>NA</code> as well, effectively deciding that an answer of “I don’t know” is the same as missing an answer</li>
</ul></li>
<li>So first step: convert <code>-8</code>, <code>-9</code>, and <code>11</code> in both variables to <code>NA</code>. For this, we’ll use the <code>mutate()</code> and <code>ifelse()</code> functions</li>
</ul>
</section>
<section id="conditional-values-with-ifelse" class="level3">
<h3 data-anchor-id="conditional-values-with-ifelse">Conditional Values with <code>ifelse()</code></h3>
<ul>
<li><code>ifelse()</code> is a really common command in <code>R</code> and has three parts
<ol type="1">
<li><code>statement</code> that can be <code>TRUE</code> or <code>FALSE</code></li>
<li>What to return <code>if</code> the <code>statement</code> is <code>TRUE</code></li>
<li><code>else</code> what to return when the <code>statement</code> is <code>FALSE</code></li>
</ol></li>
</ul>
</section>
<section id="modifying-an-existing-variable-with-mutate" class="level3">
<h3 data-anchor-id="modifying-an-existing-variable-with-mutate">Modifying an Existing Variable with <code>mutate()</code></h3>
<ul>
<li>When we want to add variables and change existing ones, we can use the <code>mutate()</code> function
<ul>
<li>The basic idea of mutate commands is <code>mutate(&lt;where to go&gt; = &lt;what to go there&gt;)</code>
<ul>
<li>This is probably the trickiest function we cover today to understand</li>
</ul></li>
<li>New variables are created if you provide <code>&lt;where to go&gt;</code> a new variable name (or nothing)</li>
<li>Variables are modified if you provide <code>&lt;where to go&gt;</code> an existing variable name</li>
<li><code>&lt;what to go there&gt;</code> can as simple as a single number all the way to a chain of piped functions, so long as there’s a clear answer for every row</li>
</ul></li>
<li>In this case, we want to modify <code>x1stuedexpct</code> to be <code>NA</code> when <code>x1stuedexpct</code> is -8, -9, or 11</li>
</ul>
<p>Now, we have three values we want to covert to NA, so we <em>could</em> do them one-at-a-time, like below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_small <span class="ot">&lt;-</span> df_small <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x1stuedexpct =</span> <span class="fu">ifelse</span>(x1stuedexpct <span class="sc">==</span> <span class="sc">-</span><span class="dv">8</span>, <span class="cn">NA</span>, x1stuedexpct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Let’s walk through this code</li>
</ul>
<ol type="1">
<li>Assign the results back to <code>df_small</code> (which will overwrite our previous <code>df_small</code>)</li>
<li>Take <code>df_small</code> and pipe <code>|&gt;</code> it into <code>mutate()</code></li>
<li>Inside <code>mutate()</code> assign our results to <code>x1stuedexpct</code> (which will modify the existing variable)</li>
<li>Modify <code>x1stuedexpct</code> with an <code>ifelse()</code> statement, which remember has 3 parts</li>
</ol>
<!-- -->
<ol type="i">
<li><code>statement</code> which is asking “is <code>x1stuedexpct == -8</code>”? - Notice <code>==</code> means “is equal to”, while <code>=</code> means “assign to”. Yes it’s confusing, but you’ll get it over time!</li>
<li><code>if</code> that <code>statement</code> is true, make it <code>NA</code></li>
<li><code>else</code> (if the statement is false) return the original variable <code>x1stuedexpct</code></li>
</ol>
<p>Okay, make sense? Let’s see what we just did (look at row 26)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_small, <span class="at">n =</span> <span class="dv">26</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23,503 × 4
   stu_id x1stuedexpct x1paredexpct x1region
    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
 1  10001            8            6        2
 2  10002           11            6        1
 3  10003           10           10        4
 4  10004           10           10        3
 5  10005            6           10        3
 6  10006           10            8        3
 7  10007            8           11        1
 8  10008            8            6        1
 9  10009           11           11        3
10  10010            8            6        1
11  10011            8            6        3
12  10012           11           11        2
13  10013            8           10        3
14  10014            2            6        3
15  10015           11           10        3
16  10016            4            6        2
17  10018            6            7        2
18  10019            8           -8        2
19  10020            8            8        4
20  10021            8           11        2
21  10022           10            8        4
22  10024            6            8        2
23  10025            8           -8        4
24  10026            7           10        3
25  10027           11            6        1
26  10028           NA           -8        3
# ℹ 23,477 more rows</code></pre>
</div>
</div>
<ul>
<li>This is fine, but we have to do it 3 times for both parent and student expectation
<ul>
<li>Instead, can anyone think (not in <code>R</code> code, just in terms of logic) how we could change our <code>statement</code> piece of the <code>ifelse()</code> to be more efficient?</li>
</ul></li>
</ul>
</section>
<section id="being-efficient-with-in-and-c" class="level3">
<h3 data-anchor-id="being-efficient-with-in-and-c">Being Efficient with <code>%in%</code> and <code>c()</code></h3>
<ul>
<li>What we can do, is group -8, -9, and 11 together into a list using <code>c()</code>
<ul>
<li><code>c()</code> is a very common function in R used to create a list</li>
</ul></li>
<li>Then, we can use the <code>%in%</code> operator to ask if that result is any of the numbers in that list
<ul>
<li>This keeps our code shorter and easier to read</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df_small <span class="ot">&lt;-</span> df_small <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x1stuedexpct =</span> <span class="fu">ifelse</span>(x1stuedexpct <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">9</span>, <span class="dv">11</span>), <span class="cn">NA</span>, x1stuedexpct),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1paredexpct =</span> <span class="fu">ifelse</span>(x1paredexpct <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">9</span>, <span class="dv">11</span>), <span class="cn">NA</span>, x1paredexpct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The code now works just as above, but instead of asking if <code>x1stuedexpct</code> is equal to -8, it asks if it’s in the list of -8, -9, and 11, then does the same for parental expectations!
<ul>
<li>Let’s view those first 26 rows again to see what we did</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_small, <span class="at">n =</span> <span class="dv">26</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23,503 × 4
   stu_id x1stuedexpct x1paredexpct x1region
    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
 1  10001            8            6        2
 2  10002           NA            6        1
 3  10003           10           10        4
 4  10004           10           10        3
 5  10005            6           10        3
 6  10006           10            8        3
 7  10007            8           NA        1
 8  10008            8            6        1
 9  10009           NA           NA        3
10  10010            8            6        1
11  10011            8            6        3
12  10012           NA           NA        2
13  10013            8           10        3
14  10014            2            6        3
15  10015           NA           10        3
16  10016            4            6        2
17  10018            6            7        2
18  10019            8           NA        2
19  10020            8            8        4
20  10021            8           NA        2
21  10022           10            8        4
22  10024            6            8        2
23  10025            8           NA        4
24  10026            7           10        3
25  10027           NA            6        1
26  10028           NA           NA        3
# ℹ 23,477 more rows</code></pre>
</div>
</div>
<ul>
<li>Just to be doubly-sure, lets check <code>count()</code> again</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_small <span class="sc">|&gt;</span> <span class="fu">count</span>(x1stuedexpct) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   x1stuedexpct     n
          &lt;dbl&gt; &lt;int&gt;
 1            1    93
 2            2  2619
 3            3   140
 4            4  1195
 5            5   115
 6            6  3505
 7            7   231
 8            8  4278
 9            9   176
10           10  4461
11           NA  6690</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_small <span class="sc">|&gt;</span> <span class="fu">count</span>(x1paredexpct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   x1paredexpct     n
          &lt;dbl&gt; &lt;int&gt;
 1            1    55
 2            2  1293
 3            3   149
 4            4  1199
 5            5   133
 6            6  4952
 7            7    76
 8            8  3355
 9            9    37
10           10  3782
11           NA  8472</code></pre>
</div>
</div>
<p>Success!</p>
</section>
<section id="creating-a-new-variable-with-mutate" class="level3">
<h3 data-anchor-id="creating-a-new-variable-with-mutate">Creating a New Variable with <code>mutate()</code></h3>
<ul>
<li>So, with that tangent out of the way, let’s get back to our original task, creating a new variable that is the highest of parental and student expectations</li>
<li>To make a new variable which is the highest of two variables, we can use our friends <code>mutate()</code> and <code>ifelse()</code> some more</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_small <span class="ot">&lt;-</span> df_small <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">high_exp =</span> <span class="fu">ifelse</span>(x1stuedexpct <span class="sc">&gt;</span> x1paredexpct, x1stuedexpct, x1paredexpct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>That code is <em>almost</em> what we want to do
<ul>
<li>If <code>x1stuedexpct</code> is higher then take that, if not, take <code>x1paredexpct</code>
<ul>
<li>There’s two things I haven’t fully accounted for though…
<ul>
<li>One doesn’t actually matter here, but might in other circumstances</li>
<li>One definitely matters here
<ul>
<li>Without scrolling past the duck, can you tell me what they might be?</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="site-attachments/Rubber-Duck.png" class="img-fluid figure-img" width="200"></p>
<figcaption>“<a href="https://www.rawpixel.com/image/6772898/png-sticker-public-domain">Rubber duck png sticker, transparent</a>” is marked with <a href="https://creativecommons.org/publicdomain/zero/1.0/?ref=openverse">CC0 1.0.</a></figcaption>
</figure>
</div>
<section id="sloppy-mistake-1-doesnt-matter-here" class="level4">
<h4 data-anchor-id="sloppy-mistake-1-doesnt-matter-here">Sloppy Mistake 1 (doesn’t matter here)</h4>
<ul>
<li>I was a little sloppy with the <code>statement</code> piece, I just asked if <code>x1stuedexpct</code> was greater than <code>x1paredexpct</code> or not
<ul>
<li>If I was being more careful, I might have said “greater than or equal to”
<ul>
<li>Why doesn’t this matter in this context, and when might it matter?</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="sloppy-mistake-2-does-matter-here" class="level4">
<h4 data-anchor-id="sloppy-mistake-2-does-matter-here">Sloppy Mistake 2 (does matter here)</h4>
<ul>
<li>Now let’s check our data frame to see the one that does matter</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_small, <span class="at">n =</span> <span class="dv">26</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23,503 × 5
   stu_id x1stuedexpct x1paredexpct x1region high_exp
    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  10001            8            6        2        8
 2  10002           NA            6        1       NA
 3  10003           10           10        4       10
 4  10004           10           10        3       10
 5  10005            6           10        3       10
 6  10006           10            8        3       10
 7  10007            8           NA        1       NA
 8  10008            8            6        1        8
 9  10009           NA           NA        3       NA
10  10010            8            6        1        8
11  10011            8            6        3        8
12  10012           NA           NA        2       NA
13  10013            8           10        3       10
14  10014            2            6        3        6
15  10015           NA           10        3       NA
16  10016            4            6        2        6
17  10018            6            7        2        7
18  10019            8           NA        2       NA
19  10020            8            8        4        8
20  10021            8           NA        2       NA
21  10022           10            8        4       10
22  10024            6            8        2        8
23  10025            8           NA        4       NA
24  10026            7           10        3       10
25  10027           NA            6        1       NA
26  10028           NA           NA        3       NA
# ℹ 23,477 more rows</code></pre>
</div>
</div>
<ul>
<li>Hmm, that seems odd, why would R consider <code>NA</code> to be greater than <code>6</code>?
<ul>
<li>Any thoughts?</li>
</ul></li>
<li>Generally, R is overly-cautious when dealing with <code>NA</code>s to ensure you don’t accidentally drop them without realizing it
<ul>
<li>For example, if I asked you what the <code>mean(c(5, 6, 4, NA))</code> would be, you’d probably say 5, right?
<ul>
<li>R is never going to just ignore the NA values like that unless we tell it to</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<ul>
<li>See, what have to explicitly tell it to remove the <code>NA</code> values</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="cn">NA</span>), <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<ul>
<li>So in our case of trying to get the highest expectation, R doesn’t want us to forget we have <code>NA</code> values, so it throws them at us.</li>
<li>For now, let’s keep the results we got, but, if it gave us an <code>NA</code> and there is a non-<code>NA</code> value in other other column, sub that in</li>
</ul>
</section>
</section>
<section id="dealing-with-missing-values-with-is.na-and" class="level3">
<h3 data-anchor-id="dealing-with-missing-values-with-is.na-and">Dealing With Missing Values with <code>is.na()</code>, <code>&amp;</code>, and <code>!</code></h3>
<ul>
<li>To do this, we will add another couple of code helpers -<code>is.na(high_exp)</code> simply asks if the <code>high_exp</code> is <code>NA</code> or not
<ul>
<li>R doesn’t let you just say <code>high_exp == NA</code> -<code>!</code> is really helpful tool, which can be used to negate or invert a command
<ul>
<li><code>!is.na(x1stuedexpct)</code> just returns the opposite of <code>is.na(x1stuedexpct)</code> so it tells us that the column is not <code>NA</code> -<code>&amp;</code> can be useful inside conditional statements, as it means both must be <code>TRUE</code> (FYI: <code>|</code> means or)</li>
</ul></li>
</ul></li>
<li>Used together, we can now ensure we have as few <code>NA</code>s as possible in the data (there will still be some when both student and parent were <code>NA</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_small <span class="ot">&lt;-</span> df_small <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">high_exp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(high_exp) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(x1stuedexpct), x1stuedexpct, high_exp),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">high_exp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(high_exp) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(x1paredexpct), x1paredexpct, high_exp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Let’s print this one last time to check our work</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_small, <span class="at">n =</span> <span class="dv">26</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23,503 × 5
   stu_id x1stuedexpct x1paredexpct x1region high_exp
    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  10001            8            6        2        8
 2  10002           NA            6        1        6
 3  10003           10           10        4       10
 4  10004           10           10        3       10
 5  10005            6           10        3       10
 6  10006           10            8        3       10
 7  10007            8           NA        1        8
 8  10008            8            6        1        8
 9  10009           NA           NA        3       NA
10  10010            8            6        1        8
11  10011            8            6        3        8
12  10012           NA           NA        2       NA
13  10013            8           10        3       10
14  10014            2            6        3        6
15  10015           NA           10        3       10
16  10016            4            6        2        6
17  10018            6            7        2        7
18  10019            8           NA        2        8
19  10020            8            8        4        8
20  10021            8           NA        2        8
21  10022           10            8        4       10
22  10024            6            8        2        8
23  10025            8           NA        4        8
24  10026            7           10        3       10
25  10027           NA            6        1        6
26  10028           NA           NA        3       NA
# ℹ 23,477 more rows</code></pre>
</div>
</div>
<ul>
<li><p>Okay, looks good!</p></li>
<li><p>There are other ways we could have gone about this analysis, some more sophisticated and slicker</p>
<ul>
<li>But, what matters more is that we checked our work as we went, caught the issues, and finished with the correct data
<ul>
<li>We will learn more tools along the way that speed things up, especially in the brand new <a href="./09-wrangle-iv.html">Data Wrangling IV Lesson</a></li>
<li>However, the more steps you take at once, the more you have to check at once!</li>
<li>There’s often never a single correct way to get to the right answer, so long as you get there, it’s clear what you did, and you catch issues as they come up</li>
</ul></li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p>“The point to keep in mind that the process is often iterative (two steps forward, one step back…) and that there’s seldom an single <em>correct way</em>.” B.T. Skinner</p>
</blockquote>
<ul>
<li>Now it’s made correctly, let’s check the counts of our new variable</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## get summary of our new variable</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df_small <span class="sc">|&gt;</span> <span class="fu">count</span>(high_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   high_exp     n
      &lt;dbl&gt; &lt;int&gt;
 1        1    71
 2        2  2034
 3        3   163
 4        4  1282
 5        5   132
 6        6  4334
 7        7   191
 8        8  5087
 9        9   168
10       10  6578
11       NA  3463</code></pre>
</div>
</div>
<ul>
<li>Hmm… We still have a large number of <code>NA</code>s, meaning neither the parent or student provided an expectation
<ul>
<li>In more sophisticated analyses, this is where we might need to think about imputation or something else to handle the missing-ness
<ul>
<li>For the sake of this lesson, however, we just want to drop the observations with <code>NA</code> for <code>high_exp</code></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="keeping-rows-based-on-a-condition-with-filter" class="level2">
<h2 data-anchor-id="keeping-rows-based-on-a-condition-with-filter">Keeping Rows Based on a Condition with <code>filter()</code></h2>
<ul>
<li>To do this, we are going to use the <code>filter()</code> command from <code>tidyverse</code></li>
<li><code>filter()</code> works by only keeping observations that <em>meet</em> the condition(s) we set
<ul>
<li>As in, to make it through the filter, a row must answer “yes” to “does it meet this condition?”</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## filter out missing values</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>df_small_cut <span class="ot">&lt;-</span> df_small <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(high_exp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>I re-used our <code>!is.na()</code> helper to keep all rows that answer “yes” to “are you not <code>NA</code>?”
<ul>
<li>Double negatives are something you’ll have to get used to in coding, sorry</li>
<li>Notice, instead of overwriting <code>df_small</code> we assigned this to a new object <code>df_small_cut</code>
<ul>
<li>Generally, when making substantial changes to a data set like dropping observations, I like to be able to double check what I did, which is easier if we make a new <code>df</code></li>
</ul></li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p>Quick Question: A commmon confusion from this lesson is between <code>filter()</code> and <code>select()</code>. Can someone explain when you’d use <code>select()</code> over <code>filter()</code>?</p>
</blockquote>
<ul>
<li>To see if that worked, let’s <code>count()</code> our new variable one more time</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df_small_cut <span class="sc">|&gt;</span> <span class="fu">count</span>(high_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   high_exp     n
      &lt;dbl&gt; &lt;int&gt;
 1        1    71
 2        2  2034
 3        3   163
 4        4  1282
 5        5   132
 6        6  4334
 7        7   191
 8        8  5087
 9        9   168
10       10  6578</code></pre>
</div>
</div>
<ul>
<li>Okay, so no <code>NA</code>s, perfect!</li>
<li>Just to be extra sure we only removed <code>NA</code>s, we can check the difference in how many rows our original <code>df_small</code> has with <code>df_small_cut</code>
<ul>
<li>Who can tell me how many rows <em>should</em> have been dropped?</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## does the original # of rows - current # or rows == NA in count?</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_small) <span class="sc">-</span> <span class="fu">nrow</span>(df_small_cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3463</code></pre>
</div>
</div>
<ul>
<li><code>nrow()</code> does what you’d expect, counts the number of rows
<ul>
<li>You could also just check by looking at the <code>df</code>s in the environment tab, but this way leaves no room for mental math errors</li>
</ul></li>
</ul>
<section id="summarizing-data-with-summarize" class="level3">
<h3 data-anchor-id="summarizing-data-with-summarize">Summarizing Data with <code>summarize()</code></h3>
<ul>
<li>Okay, so we have our data selected, we made our <code>high_exp</code> variable, and we’ve done some work to handle missing data</li>
<li>In our week one data talk we discussed how massive tables of data are not particularly helpful to for someone to read or interpret
<ul>
<li>We will cover how to make graphs of our data in a few weeks</li>
<li>For our final task today, we are going to make some summary tables using <code>summarize()</code> from the <code>tidyverse</code></li>
</ul></li>
<li><code>summarize()</code> allows us to apply a summary statistic (mean, sd, median, etc.) to a column in our data</li>
<li><code>summarize()</code> takes an entire data frame as an input, and spits out a small data frame with the just the summary variables
<ul>
<li>Note: for this reason, you rarely ever want to assign <code>&lt;-</code> the output of <code>summarize()</code> back to the main data frame object, as you’ll overwrite it
<ul>
<li>You can either spit the summary tables out into the console without assignment (which we will do) or if you need to use them for something else, assign them to a new object</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">## get average (without storing)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>df_small_cut <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">mean</span>(high_exp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `mean(high_exp)`
             &lt;dbl&gt;
1             7.27</code></pre>
</div>
</div>
<ul>
<li>See, the output is a 1x1 table with the mean expectation <code>mean(high_exp)</code> of 7.27, just above a bachelors degree
<ul>
<li>Note: if we want to name the summary variable, we can name it just like we did earlier in <code>mutate()</code> with a single <code>=</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df_small_cut <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">mean_exp =</span> <span class="fu">mean</span>(high_exp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_exp
     &lt;dbl&gt;
1     7.27</code></pre>
</div>
</div>
<ul>
<li>But, that wasn’t quite the question we were asked
<ul>
<li>We were asked if it varied by region…
<ul>
<li>For time’s sake, I can tell you the region variable is <code>x1region</code> and splits the US in 4 Census regions</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="grouping-data-with-group_by" class="level3">
<h3 data-anchor-id="grouping-data-with-group_by">Grouping Data with <code>group_by()</code></h3>
<ul>
<li>The <code>group_by()</code> function, following the <code>tidyverse</code> principle of intuitive naming, <em>groups</em> the data and outputs <em>by</em> the variable(s) you say
<ul>
<li>So, since we want to calculate the average high expectation by region, we <code>group_by(x1region)</code>
<ul>
<li>Since we just want it for our <code>summarize()</code>, we just add it to the pipe
<ul>
<li>If you wanted to save the data in it’s <code>group_by()</code>-ed state, you could assign it to something</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## get grouped average</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>df_small_cut <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(x1region) <span class="sc">|&gt;</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_exp =</span> <span class="fu">mean</span>(high_exp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  x1region mean_exp
     &lt;dbl&gt;    &lt;dbl&gt;
1        1     7.39
2        2     7.17
3        3     7.36
4        4     7.13</code></pre>
</div>
</div>
<ul>
<li>Success! While expectations are similar across the country, there’s some variance by region
<ul>
<li>While there are few things we could do to make this a little fancier (e.g., changing the region numbers to names, formatting the table, etc.) we have answered our question, and have clear documentation of how we got here, so I will call that a win!</li>
</ul></li>
</ul>
</section>
<section id="saving-data-with-write_csv" class="level3">
<h3 data-anchor-id="saving-data-with-write_csv">Saving Data with <code>write_csv()</code></h3>
<ul>
<li>Sometimes we want to be able to access objects from scripts without having to re-run the whole thing
<ul>
<li>Remember: one of the main advantages of R is the data we read in is untouched</li>
</ul></li>
<li>To do this, we want to <code>write_</code> a new <code>csv()</code> file, containing our modified data
<ul>
<li>unlike <code>read_csv()</code> which only needed a file name/path, <code>write_csv()</code> needs to know what you’re trying to save and the file name/path you want to save it to
<ul>
<li>The only way you can overwrite or change the original data is by saving to the same file name as the original data, so <strong>NEVER</strong> do that!</li>
</ul></li>
</ul></li>
<li>Since we didn’t assign our summary table to anything, we can just add <code>write_csv()</code> to the end of the pipe and add a <code>file.path()</code>
<ul>
<li>If you want to save a data frame you already assigned to an object <code>write_csv(&lt;object&gt;, file.path(&lt;path&gt;))</code> would work just fine!</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">## write with useful name</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>df_small_cut <span class="sc">|&gt;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(x1region) <span class="sc">|&gt;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_exp =</span> <span class="fu">mean</span>(high_exp)) <span class="sc">|&gt;</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"region-expects.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Phew!</p>
</section>
</section>
<section id="appendix-all-at-once" class="level2">
<h2 data-anchor-id="appendix-all-at-once">Appendix: All at Once</h2>
<p>We went through that piece by piece to demonstrate each function, but, there’s no reason we can’t just <code>|&gt;</code> pipe it all together</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Let's redo the analysis above, but with a fully chained set of</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="do">## functions.</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="do">## start with original df</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## select columns we want</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(stu_id, x1stuedexpct, x1paredexpct, x1region) <span class="sc">|&gt;</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">## If expectation is -8, -9. or 11, make it NA</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">student_exp =</span> <span class="fu">ifelse</span>(x1stuedexpct <span class="sc">%in%</span> <span class="fu">list</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">9</span>, <span class="dv">11</span>), <span class="cn">NA</span>, x1stuedexpct),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">parent_exp =</span> <span class="fu">ifelse</span>(x1paredexpct <span class="sc">%in%</span> <span class="fu">list</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">9</span>, <span class="dv">11</span>), <span class="cn">NA</span>, x1paredexpct)) <span class="sc">|&gt;</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Make a new variable called high_exp that is the higher or parent and student exp</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">high_exp =</span> <span class="fu">ifelse</span>(student_exp <span class="sc">&gt;</span> parent_exp, student_exp, parent_exp)) <span class="sc">|&gt;</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## If one exp is NA but the other isn't, keep the value not the NA</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">high_exp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(high_exp) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(student_exp), student_exp, high_exp),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">high_exp =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(high_exp) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(parent_exp), parent_exp, high_exp)) <span class="sc">|&gt;</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Drop is high_exp is still NA (neither parent or student answereed)</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(high_exp)) <span class="sc">|&gt;</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Group the results by region</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(x1region) <span class="sc">|&gt;</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Get the mean of high_exp (by region)</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_exp =</span> <span class="fu">mean</span>(high_exp)) <span class="sc">|&gt;</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Write that to a .csv file</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"region-expects-chain.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To double check, let’s just check these are the same…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>non_chain <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"region-expects.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (2): x1region, mean_exp

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>chain <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"region-expects-chain.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (2): x1region, mean_exp

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(non_chain, chain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>WooHoo!</p>
</section>
<section id="final-notes" class="level2">
<h2 data-anchor-id="final-notes">Final notes</h2>
<ul>
<li>This rather lengthy lesson has thrown you in the (medium) deep end of the coding pool
<ul>
<li>By no means are you expected to get everything we just did
<ul>
<li>We will continue to revisit all these commands throughout the class, by the end of the semester, they will be second nature!</li>
</ul></li>
</ul></li>
<li>We also saw how to use code to answer a realistic question we might be asked in a data management job, a translation skill that will prove invaluable later on!
<ul>
<li>We had to plan out steps and then make some adjustments along the way (e.g., our <code>NA</code> issues), that’s all part of the process!</li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p>“Becoming a better quantitative researcher mostly means becoming a better translator: question –&gt; data/coding –&gt; answer.” B.T. Skinner</p>
</blockquote>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><a href="./site-attachments/assignments/assignment-02.qmd"><i class="fa-solid fa-question" aria-label="question"></i> Assignment Template</a></p>
<p>Use the <code>hsls_small.csv</code> data set from the lesson answer the following questions</p>
<ul>
<li>Throughout, you <strong>should</strong> account for missing values by dropping them</li>
</ul>
<blockquote class="blockquote">
<p>Hint: You’re going to need the <a href="https://nces.ed.gov/datalab/onlinecodebook">code book</a> to identify the necessary variables</p>
</blockquote>
<section id="question-one" class="level2">
<h2 data-anchor-id="question-one">Question One</h2>
<p><strong>a)</strong> What is the average (mean) standardized math score?</p>
<p><strong>b)</strong> How does this differ by gender?</p>
</section>
<section id="question-two" class="level2">
<h2 data-anchor-id="question-two">Question Two</h2>
<p><strong>a)</strong> Among those students who are under 185% of the federal poverty line in the base year of the survey, what is the median household income category? (Include a description what that category represents)</p>
</section>
<section id="question-three" class="level2">
<h2 data-anchor-id="question-three">Question Three</h2>
<p><strong>a)</strong> Of the students who earned a high school credential (traditional diploma or GED), what percentage earned a GED or equivalency?</p>
<p><strong>b)</strong> How does this differ by region?</p>
</section>
<section id="question-four" class="level2">
<h2 data-anchor-id="question-four">Question Four</h2>
<p><strong>a)</strong> What percentage of students ever attended a post-secondary institution? (as of the data collection in february 2016)</p>
<p><strong>b)</strong> Give the cross tabulation for both family incomes above/below $35,000 and region<br>
</p>
<ul>
<li>This means you should have percentages for 8 groups: above/below $35,000 within each region</li>
</ul>
<blockquote class="blockquote">
<p>Hint: <code>group_by()</code> can be given more than one group</p>
</blockquote>
<!--
Once complete, turn in the .qmd file (must render successfully) to Canvas by Tuesday 12:00pm following the lesson.
Assignments will be graded before next lesson on Wednesday in line with the grading policy outlined in the syllabus.
-->
</section>
<section id="submission" class="level2">
<h2 data-anchor-id="submission">Submission</h2>
<p>Once complete turn in the .qmd file (<strong>it must render/run</strong>) to Canvas by the due date (usually <strong>Tuesday 12:00pm following the lesson</strong>). Assignments will be graded before next lesson on Wednesday in line with the grading policy outlined in the syllabus.</p>
</section>
</div>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/capaldi\.info\/7916");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://capaldi.info">
<p>M.J. Capaldi</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://quarto.org/docs/websites">
<p>Built with Quarto</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ttalVlatt/7916">
      <i class="bi bi-github" role="img" aria-label="Website Code Available Here">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>